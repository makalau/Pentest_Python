import dns.resolver
from os import system 
from sys import argv

resolver = dns.resolver.Resolver()
    
def BruteforceDNS(wordlist):
    print("*** Iniciando a consulta através de uma wordlist...")
    print(f"Wordlist iniciada se chama: {wordlist}")
    dominio = str(input("Digite o domínio: ").lower().strip())
    print("[1 - ANY] , [2 - A],  [3 - AAAA], [4 - MX ] ")
    options = ["ANY", "A", "AAAA", "MX"]
    argumento = int(input("Selecione a opção desejada: "))
    system("cls")
    argumento = options[argumento-1]
    with open(wordlist, "r") as arquivo:
        for valor in arquivo:
            valor = valor.split("\n")
            subdominio = valor[0] + "." + dominio
            dns_Resolver(f"{subdominio}", argumento)
            
            
def dns_Resolver(dominio, argumento):
    try:
        resultados = resolver.resolve(dominio, argumento)
        print()
        print(f"Consulta DNS Resolver opção selecionada: {argumento}")
        print(f"Subdominio testado: {dominio}")
        for resultado in resultados:
            print(f"Resultados obtidos: {resultado}")
        
        print("-"*60)
    except:
        pass
        

def query():
    while True:
        dominio = str(input("Digite o domínio: ").lower().strip())
        print("[1 - ANY] , [2 - A],  [3 - AAAA], [4 - MX ] ")
        options = ["ANY", "A", "AAAA", "MX"]
        argumento = int(input("Selecione a opção desejada: "))
        argumento = options[argumento-1]
        dns_Resolver(dominio, argumento)
        continua = str(input("Deseja iniciar uma nova consulta?[S/N]: ").lower().strip())
        if "n" in continua:
            break


BruteforceDNS(argv[1]) if len(argv) > 1 else query()
